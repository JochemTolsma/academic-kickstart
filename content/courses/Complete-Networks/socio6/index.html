---
title: RSiena
author: JochemTolsma
date: '2020-09-22'
slug: socio6
categories:
  - R
  - Social Networks
tags: []
linktitle: RSiena
summary: "igraph, social networks, plotting, tutorial, R, Lavaan"
lastmod: '2020-09-15T08:27:34+02:00'
type: book
weight: 45
 
output:
  blogdown::html_page:
    highlight: "haddock"
    number_sections: yes
    self_contained: no
    toc: true
    fig_width: 6
    dev: "svg"
editor_options: 
  chunk_output_type: console
---

<script src="/rmarkdown-libs/accessible-code-block/empty-anchor.js"></script>
<script src="/rmarkdown-libs/clipboard/clipboard.min.js"></script>
<link href="/rmarkdown-libs/primer-tooltips/build.css" rel="stylesheet" />
<link href="/rmarkdown-libs/klippy/css/klippy.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/klippy/js/klippy.min.js"></script>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#rsiena"><span class="toc-section-number">1</span> RSiena</a><ul>
<li><a href="#assumptions"><span class="toc-section-number">1.1</span> Assumptions</a></li>
<li><a href="#rate-function"><span class="toc-section-number">1.2</span> Rate function</a></li>
<li><a href="#interpretation-of-parameters"><span class="toc-section-number">1.3</span> Interpretation of parameters</a></li>
</ul></li>
</ul>
</div>

<!--set global settings-->
<!--copy to clipboard-->
<p><script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script><script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<!---
https://www.w3schools.com/w3css/w3css_buttons.asp
https://www.freecodecamp.org/news/a-quick-guide-to-styling-buttons-using-css-f64d4f96337f/
---></p>
<button onclick="window.location.href=&#39;static/index.Rmd&#39;;">
download code
</button>
<div id="rsiena" class="section level1">
<h1><span class="header-section-number">1</span> RSiena</h1>
<div id="assumptions" class="section level2">
<h2><span class="header-section-number">1.1</span> Assumptions</h2>
<ul>
<li>ministep: one actor per time step (no coordination), one tie change per time step<br />
</li>
<li>no memory: the same choice set is evaluated the same each time.</li>
<li>no strategic action: actors do not anticipate that one (negatively evaluated) tie change at t1 may open up the opportunity for a (very positively) tie change at t2.</li>
<li>local networks: actors base their decisions only on the evaluation of their own local network (no altruism).</li>
</ul>
</div>
<div id="rate-function" class="section level2">
<h2><span class="header-section-number">1.2</span> Rate function</h2>
<p>We find the rate function in the manual on page 43:</p>
<p><span class="math display">\[ \lambda_+(x^0)=\Sigma_i \lambda_i (x^0)\]</span>
But what does this mean?</p>
<ul>
<li><span class="math inline">\(x^0\)</span> is simply the current network.<br />
</li>
<li><span class="math inline">\(\lambda_i\)</span> is the waiting time of actor <em>i</em>.</li>
</ul>
<p>But how do we determine the waiting time of actor <em>i</em>? Well these waiting times are exponentially distributed with a rate parameter, which, if the network is very large, is <span class="math inline">\(\lambda_+\)</span> , the sum of all individual waiting times: <span class="math inline">\(\Sigma_i \lambda_i (x^0)\)</span>. See below for two examples:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r highlightt numberLines"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>dist_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">10000</span>, <span class="dt">rate =</span> <span class="dv">5</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">hist</span>(dist_<span class="dv">5</span>, <span class="dt">main =</span> <span class="st">&quot;rate parameter = 5&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;lambda_i&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="dv">9</span>))</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>dist_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">10000</span>, <span class="dt">rate =</span> <span class="dv">10</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">hist</span>(dist_<span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;rate parameter = 10&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;lambda_i&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="dv">9</span>))</span></code></pre></div>
<p><img src="/courses/Complete-Networks/socio6/index_files/figure-html/unnamed-chunk-1-1.svg" width="576" /></p>
<p>The expected waiting time is simply the mean of all individual waiting times <span class="math inline">\(lambda_i\)</span>. We saved all waiting times in <code>dist_5</code> and in <code>dist_10</code>.</p>
<p>Thus:</p>
<ul>
<li><code>mean(dist_5)</code>= 0.1991519 <span class="math inline">\(\approx\)</span> $  $ = 1/5 = 0.2<br />
</li>
<li><code>mean(dist_10)</code>= 0.0985059 <span class="math inline">\(\approx\)</span> $  $ = 1/10 = 0.1</li>
</ul>
<p>Thus each actor gets a waiting time <span class="math inline">\(\lambda_i\)</span> sampled from the exponential distribution with the specified rate parameter. Based on these waiting times, the probability is determined that actor <em>i</em> will be next:</p>
<p><span class="math display">\[ \frac{\lambda_i(x^0)}{\lambda_+(x^0)} \]</span>
{{% alert warning %}}
To be honest, I think waiting time is a wrong label. Because nodes with the longest waiting time have the highest probability to be chosen!<br />
{{% /alert %}}</p>
<p>Let us make this more concrete. Suppose we have a network of 4 nodes and the rate parameter is 5.</p>
<p>The individual waiting times are:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r highlightt numberLines"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">set.seed</span>(<span class="dv">34647</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>waitingtimes &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">4</span>, <span class="dt">rate =</span> <span class="dv">5</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;waitingtime&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">round</span>(waitingtimes, <span class="dv">2</span>), <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;waitingtime 1 0.45&quot; &quot;waitingtime 2 0.13&quot; &quot;waitingtime 3 0.52&quot; &quot;waitingtime 4 0.21&quot;</code></pre>
<p>Thus <span class="math inline">\(\lambda_+(x^0)\)</span> = <code>sum(waitingtimes)</code> = 1.3174602</p>
<p>Which makes for the following probabilities:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r highlightt numberLines"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>waitingtimes<span class="op">/</span><span class="kw">sum</span>(waitingtimes)</span></code></pre></div>
<pre><code>## [1] 0.3426805 0.1016378 0.3933320 0.1623498</code></pre>
<p>And whose turn will it be?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r highlightt numberLines"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>actor &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dt">prob =</span> waitingtimes)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;chosen actor:&quot;</span>, actor, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;chosen actor: 3&quot;</code></pre>
<p>Now let us repeat this process a couple of times:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r highlightt numberLines"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">245651</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>time &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="cf">for</span> (steps <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb8-4"><a href="#cb8-4"></a>    waitingtimes &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">4</span>, <span class="dt">rate =</span> <span class="dv">5</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a>    probabilities &lt;-<span class="st"> </span>waitingtimes<span class="op">/</span><span class="kw">sum</span>(waitingtimes)</span>
<span id="cb8-6"><a href="#cb8-6"></a>    actor &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dt">prob =</span> waitingtimes)</span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;chosen actor:&quot;</span>, actor, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb8-8"><a href="#cb8-8"></a>    time &lt;-<span class="st"> </span>time <span class="op">+</span><span class="st"> </span>waitingtimes[actor]</span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;total time:&quot;</span>, time, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb8-10"><a href="#cb8-10"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;chosen actor: 4&quot;
## [1] &quot;total time: 0.188847544408383&quot;
## [1] &quot;chosen actor: 2&quot;
## [1] &quot;total time: 0.633620880510578&quot;
## [1] &quot;chosen actor: 3&quot;
## [1] &quot;total time: 0.98291679876472&quot;
## [1] &quot;chosen actor: 3&quot;
## [1] &quot;total time: 1.22129838765698&quot;
## [1] &quot;chosen actor: 3&quot;
## [1] &quot;total time: 1.40387658942681&quot;</code></pre>
<p>So how many opportunities for change do we have before the total time exceeds 1? Well 4.
If we repeat the process but with a rate parameter of 10. What would we find?</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource r highlightt numberLines"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">245651</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>time &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="cf">for</span> (steps <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb10-4"><a href="#cb10-4"></a>    waitingtimes &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">4</span>, <span class="dt">rate =</span> <span class="dv">10</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>    probabilities &lt;-<span class="st"> </span>waitingtimes<span class="op">/</span><span class="kw">sum</span>(waitingtimes)</span>
<span id="cb10-6"><a href="#cb10-6"></a>    actor &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dt">prob =</span> waitingtimes)</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;chosen actor:&quot;</span>, actor, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb10-8"><a href="#cb10-8"></a>    time &lt;-<span class="st"> </span>time <span class="op">+</span><span class="st"> </span>waitingtimes[actor]</span>
<span id="cb10-9"><a href="#cb10-9"></a>    <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;total time:&quot;</span>, time, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb10-10"><a href="#cb10-10"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;chosen actor: 4&quot;
## [1] &quot;total time: 0.0944237722041917&quot;
## [1] &quot;chosen actor: 2&quot;
## [1] &quot;total time: 0.316810440255289&quot;
## [1] &quot;chosen actor: 3&quot;
## [1] &quot;total time: 0.49145839938236&quot;
## [1] &quot;chosen actor: 3&quot;
## [1] &quot;total time: 0.610649193828492&quot;
## [1] &quot;chosen actor: 3&quot;
## [1] &quot;total time: 0.701938294713407&quot;
## [1] &quot;chosen actor: 4&quot;
## [1] &quot;total time: 0.738830435835778&quot;
## [1] &quot;chosen actor: 1&quot;
## [1] &quot;total time: 0.898197567791467&quot;
## [1] &quot;chosen actor: 4&quot;
## [1] &quot;total time: 1.10614433369982&quot;
## [1] &quot;chosen actor: 2&quot;
## [1] &quot;total time: 1.16367037041433&quot;
## [1] &quot;chosen actor: 4&quot;
## [1] &quot;total time: 1.18615504420682&quot;</code></pre>
<p>We would find there are 8 opportunities for change. Thus the larger the rate parameter the more opportunities for change per actor there are within a given time period. And in RSiena the optimal value for the rate parameter is estimated. The time period in RSiena is set to be the size of the network. This leads to a nice interpretation of the estimated rate parameter. From the above we know that the mean waiting time for any actor will be $  $ and thus that the estimated number
of opportunities for change per actor in a time period will be the estimated value of the rate_parameter.</p>
</div>
<div id="interpretation-of-parameters" class="section level2">
<h2><span class="header-section-number">1.3</span> Interpretation of parameters</h2>
<ul>
<li>to do</li>
</ul>
<p>Latest Version: 22-09-2020</p>
<p>Please email any comments to: <a href="mailto:j.tolsma@ru.nl" class="email">j.tolsma@ru.nl</a></p>
</div>
</div>
